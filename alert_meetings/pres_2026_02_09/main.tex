\documentclass[aspectratio=169]{beamer}

\usepackage{tikz}
\usepackage{xcolor}
\usepackage{caption}
\usepackage{subcaption}

\usetheme{MyStyle}   % loads beamerthemeMyStyle.sty


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{ALERT meeting - Kalman Filter \\ updates}
%\title{My Presentation Title}
\author{Felix Touchte Codjo}
\institute{IJCLab}
\date{\today}


\begin{document}

\begin{frame}[plain] % remove header, footer, barre de navigation
\titlepage
\end{frame}

%\begin{frame}{Outline}
%\tableofcontents
%\end{frame}

%\section{Intro}

\begin{frame}{Updates}
    \begin{itemize}
        \item The new AHDC geometry is available in \textbf{coatjava} and \textbf{gemc}
            \begin{itemize}
                \item \textbf{coatjava} since the release \textbf{13.6.0}
                \item \textbf{gemc} in dev version only
            \end{itemize}
        \item I moved the \textbf{Kalman Filter} in \textbf{ALERTEngine}
            \begin{itemize}
                \item Require \textbf{AHDCEngine} to have been run before
                \item Remove redundant attributes in the object \textbf{Track} (everything with the \textbf{\_kf} extension)
                \item Update the bank \textbf{AHDC::hits} in the ALERTEngine
                \item \alert{Define the \textbf{number of iterations} and the \textbf{PID} as variable in the Kalman Filter}
            \end{itemize}
    \end{itemize}
\end{frame}

% \begin{frame}{Updates}
%     \begin{itemize}
%     \item For now, moving the Kalman Filter in ALERTEngine has no effect on the result but:
%         \begin{itemize}
%             \item the new implementation allows us to use it several times
%             \item example:  \textbf{KF 1 $\rightarrow$ clean bad hits $\rightarrow$ KF 2}
%         \end{itemize}
%     \item Each fitter has the possibility to define these quantities
%     \end{itemize}
%     \begin{figure}
%         \centering
%         \begin{subfigure}{0.3\textwidth}
%             \includegraphics[width=\linewidth]{figures/trackBank.png}
%         \end{subfigure}
%         \hspace{0.01\textwidth}
%         \begin{subfigure}{0.3\textwidth}
%             \includegraphics[width=\linewidth]{figures/kftrackBank.png}
%         \end{subfigure}
%     \end{figure}
% \end{frame}

\begin{frame}{Updates}
    \begin{itemize}
    \item For now, moving the Kalman Filter in ALERTEngine has no effect on the result but:
        \begin{itemize}
            \item the new implementation allows us to use it several times
            \item example:  \textbf{KF 1 $\rightarrow$ clean bad hits $\rightarrow$ KF 2}
        \end{itemize}
    \item Also, it was a mistake at the beginning, but now these quantities can be filled independently (the values for the Helix fitter have to be set)
    \end{itemize}
    \begin{figure}
        \centering
        \begin{subfigure}{0.3\textwidth}
            \begin{tikzpicture}
                % Image de fond
                \node[anchor=south west] (img) at (0,0) {\includegraphics[width=\linewidth]{figures/trackBank.png}};
                % Coordonnées normalisées 0–1
                \begin{scope}[x={(img.south east)}, y={(img.north west)}]
                    \draw[red, ultra thick] (0.05,0.05) rectangle (0.7, 0.48);
                    %\node[blue] at (0.6,0.55) {Point important};
                \end{scope}
            \end{tikzpicture}
        \end{subfigure}
        \hspace{0.01\textwidth}
        \begin{subfigure}{0.3\textwidth}
            \begin{tikzpicture}
                % Image de fond
                \node[anchor=south west] (img) at (0,0) {\includegraphics[width=\linewidth]{figures/kftrackBank.png}};
                % Coordonnées normalisées 0–1
                \begin{scope}[x={(img.south east)}, y={(img.north west)}]
                    \draw[red, ultra thick] (0.05,0.05) rectangle (0.7, 0.43);
                    %\node[blue] at (0.6,0.55) {Point important};
                \end{scope}
            \end{tikzpicture}
        \end{subfigure}
    \end{figure}
\end{frame}

\begin{frame}{Next steps}
    \begin{enumerate}
        \item Make a routine to eventually clean bad hits after a first use of the Kalman Filter
        \item Include the ATOF hit in the Kalman Filter
            \begin{itemize}
                \item It was one of interest of moving the KF in ALERTEngine
                \item For now, the AHDC-ATOF matching is only done with \textbf{wegdes}. We ideally would like to use \textbf{ATOF bars}
            \end{itemize}
        \item Check that the PID is correctly used by the Kalman Filter (RungeKutta and energy lost)
    \end{enumerate}
\end{frame}

\end{document}


